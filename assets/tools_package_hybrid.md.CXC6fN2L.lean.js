import{_ as i,c as a,a3 as n,o as l}from"./js/framework-ohJJpums.js";const p="/assets/png/image-27-MJDe3YYk.png",e="/assets/png/image-28-BBdweTC1.png",y=JSON.parse('{"title":"ğŸ“± Hybrid æ··åˆå¼€å‘å®Œå…¨æŒ‡å—","description":"æ··åˆå¼€å‘æŠ€æœ¯è¯¦è§£ï¼ŒåŒ…æ‹¬åŸç†å®ç°ã€H5ä¸åŸç”Ÿäº¤äº’ã€DSBridge æ¡†æ¶ç­‰ï¼Œå®ç°ä¸€æ¬¡å¼€å‘å¤šå¤„è¿è¡Œ","frontmatter":{"title":"ğŸ“± Hybrid æ··åˆå¼€å‘å®Œå…¨æŒ‡å—","description":"æ··åˆå¼€å‘æŠ€æœ¯è¯¦è§£ï¼ŒåŒ…æ‹¬åŸç†å®ç°ã€H5ä¸åŸç”Ÿäº¤äº’ã€DSBridge æ¡†æ¶ç­‰ï¼Œå®ç°ä¸€æ¬¡å¼€å‘å¤šå¤„è¿è¡Œ","outline":"deep"},"headers":[],"relativePath":"tools/package/hybrid.md","filePath":"tools/package/hybrid.md","lastUpdated":1753876686000}'),h={name:"tools/package/hybrid.md"};function t(k,s,r,E,d,g){return l(),a("div",null,s[0]||(s[0]=[n('<h1>ğŸ“± Hybrid æ··åˆå¼€å‘å®Œå…¨æŒ‡å—</h1><blockquote><p>Hybrid App ä¸»è¦ä»¥ JS+Native ä¸¤è€…ç›¸äº’è°ƒç”¨ä¸ºä¸»ï¼Œä»å¼€å‘å±‚é¢å®ç°&quot;ä¸€æ¬¡å¼€å‘ï¼Œå¤šå¤„è¿è¡Œ&quot;çš„æœºåˆ¶ï¼Œæˆä¸ºçœŸæ­£é€‚åˆè·¨å¹³å°çš„å¼€å‘ã€‚</p></blockquote><h2 id="1-" tabindex="-1">1. æ··åˆå¼€å‘æ¦‚è¿° <a class="header-anchor" href="#1-" aria-label="Permalink to &quot;1. æ··åˆå¼€å‘æ¦‚è¿°&quot;">â€‹</a></h2><p>Hybrid App å…¼å…·äº† Native App è‰¯å¥½ç”¨æˆ·ä½“éªŒçš„ä¼˜åŠ¿ï¼Œä¹Ÿå…¼å…·äº† Web App ä½¿ç”¨ HTML5 è·¨å¹³å°å¼€å‘ä½æˆæœ¬çš„ä¼˜åŠ¿ã€‚</p><h3 id="1-1-" tabindex="-1">1.1 æ··åˆå¼€å‘ä¼˜åŠ¿ <a class="header-anchor" href="#1-1-" aria-label="Permalink to &quot;1.1 æ··åˆå¼€å‘ä¼˜åŠ¿&quot;">â€‹</a></h3><ul><li><strong>è·¨å¹³å°å¼€å‘</strong>ï¼šé€šè¿‡æ··åˆå¼€å‘ï¼Œå¼€å‘è€…å¯ä»¥åˆ©ç”¨ä¸€å¥—ä»£ç åº“åŒæ—¶æ„å»ºé€‚ç”¨äºå¤šä¸ªå¹³å°çš„åº”ç”¨ç¨‹åºï¼Œé™ä½äº†å¼€å‘æˆæœ¬å’Œæ—¶é—´ã€‚</li><li><strong>å¿«é€Ÿè¿­ä»£</strong>ï¼šWeb æŠ€æœ¯å…·æœ‰å¿«é€Ÿè¿­ä»£çš„ç‰¹ç‚¹ï¼Œå¼€å‘è€…å¯ä»¥å¿«é€Ÿåœ°æ›´æ–°åº”ç”¨ç•Œé¢å’Œä¸šåŠ¡é€»è¾‘ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</li><li><strong>ä¸°å¯Œçš„ Web èµ„æº</strong>ï¼šWeb æŠ€æœ¯æ‹¥æœ‰ä¸°å¯Œçš„èµ„æºå’Œåº“ï¼Œå¦‚å‰ç«¯æ¡†æ¶ã€UI ç»„ä»¶ç­‰ï¼Œå¼€å‘è€…å¯ä»¥æ–¹ä¾¿åœ°åˆ©ç”¨è¿™äº›èµ„æºæ¥æ„å»ºåº”ç”¨ã€‚</li></ul><h3 id="1-2-" tabindex="-1">1.2 æ··åˆå¼€å‘æŒ‘æˆ˜ <a class="header-anchor" href="#1-2-" aria-label="Permalink to &quot;1.2 æ··åˆå¼€å‘æŒ‘æˆ˜&quot;">â€‹</a></h3><ul><li><strong>æ€§èƒ½é—®é¢˜</strong>ï¼šç”±äº WebView çš„æ¸²æŸ“æ•ˆç‡ä½äºåŸç”Ÿä»£ç ï¼Œæ··åˆåº”ç”¨åœ¨æ€§èƒ½æ–¹é¢å¯èƒ½ä¸å¦‚åŸç”Ÿåº”ç”¨ã€‚</li><li><strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼šæ··åˆåº”ç”¨åœ¨ç”¨æˆ·ä½“éªŒæ–¹é¢ä¹Ÿå¯èƒ½å—åˆ° WebView çš„é™åˆ¶ï¼Œå¦‚è§¦æ§å“åº”é€Ÿåº¦ã€åŠ¨ç”»æ•ˆæœç­‰ã€‚</li><li><strong>è·¨å¹³å°é€‚é…éš¾åº¦</strong>ï¼šè™½ç„¶æ··åˆå¼€å‘å¯ä»¥å®ç°è·¨å¹³å°å¼€å‘ï¼Œä½†ä¸åŒå¹³å°ä¹‹é—´çš„å·®å¼‚ä»ç„¶éœ€è¦å¼€å‘è€…è¿›è¡Œå¤§é‡çš„é€‚é…å·¥ä½œã€‚</li></ul><h2 id="2-" tabindex="-1">2. ç§»åŠ¨åº”ç”¨å¼€å‘æ–¹å¼å¯¹æ¯” <a class="header-anchor" href="#2-" aria-label="Permalink to &quot;2. ç§»åŠ¨åº”ç”¨å¼€å‘æ–¹å¼å¯¹æ¯”&quot;">â€‹</a></h2><p>ç§»åŠ¨åº”ç”¨å¼€å‘ä¸»è¦æœ‰ä¸‰ç§æ–¹å¼ï¼š</p><table tabindex="0"><thead><tr><th>å¼€å‘æ–¹å¼</th><th>æè¿°</th><th>ä¼˜åŠ¿</th><th>åŠ£åŠ¿</th></tr></thead><tbody><tr><td><strong>Native App</strong></td><td>åŸç”Ÿåº”ç”¨ç¨‹åº</td><td>æ€§èƒ½æœ€ä½³ã€ç”¨æˆ·ä½“éªŒå¥½ã€å¯è®¿é—®æ‰€æœ‰è®¾å¤‡åŠŸèƒ½</td><td>å¼€å‘æˆæœ¬é«˜ã€ç»´æŠ¤å¤šå¹³å°ç‰ˆæœ¬</td></tr><tr><td><strong>Web App</strong></td><td>ç½‘é¡µåº”ç”¨ç¨‹åº</td><td>å¼€å‘æˆæœ¬ä½ã€è·¨å¹³å°ã€æ˜“äºæ›´æ–°</td><td>æ€§èƒ½è¾ƒå·®ã€åŠŸèƒ½å—é™ã€ä¾èµ–ç½‘ç»œ</td></tr><tr><td><strong>Hybrid App</strong></td><td>æ··åˆåº”ç”¨ç¨‹åº</td><td>ç»“åˆå‰ä¸¤è€…ä¼˜åŠ¿ã€ä¸€æ¬¡å¼€å‘å¤šå¤„è¿è¡Œ</td><td>æ€§èƒ½ä»‹äºä¸¤è€…ä¹‹é—´ã€éƒ¨åˆ†åŠŸèƒ½å—é™</td></tr></tbody></table><p><img src="'+p+'" alt="ç§»åŠ¨åº”ç”¨å¼€å‘æ–¹å¼å¯¹æ¯”"></p><p><img src="'+e+`" alt="æ··åˆå¼€å‘æ¶æ„å›¾"></p><h2 id="3-" tabindex="-1">3. æ··åˆå¼€å‘çš„åŸç†ä¸å®ç° <a class="header-anchor" href="#3-" aria-label="Permalink to &quot;3. æ··åˆå¼€å‘çš„åŸç†ä¸å®ç°&quot;">â€‹</a></h2><p>æ··åˆå¼€å‘çš„æ ¸å¿ƒåŸç†æ˜¯é€šè¿‡åœ¨åŸç”Ÿåº”ç”¨ä¸­åµŒå…¥ WebView ç»„ä»¶ï¼Œç”¨äºåŠ è½½å’Œæ¸²æŸ“ Web é¡µé¢ã€‚å¼€å‘è€…å¯ä»¥åˆ©ç”¨ HTML5ã€CSS å’Œ JavaScript ç­‰æŠ€æœ¯æ„å»ºåº”ç”¨ç•Œé¢å’Œä¸šåŠ¡é€»è¾‘ï¼Œç„¶åé€šè¿‡ WebView ä¸åŸç”Ÿä»£ç è¿›è¡Œäº¤äº’ã€‚è¿™ç§äº¤äº’é€šå¸¸åŒ…æ‹¬æ•°æ®ä¼ é€’ã€äº‹ä»¶å¤„ç†å’Œ UI æ›´æ–°ç­‰æ–¹é¢ã€‚</p><h3 id="3-1-" tabindex="-1">3.1 å…³é”®æŠ€æœ¯ <a class="header-anchor" href="#3-1-" aria-label="Permalink to &quot;3.1 å…³é”®æŠ€æœ¯&quot;">â€‹</a></h3><ul><li><strong>WebView çš„ä½¿ç”¨</strong>ï¼šWebView æ˜¯åŸç”Ÿåº”ç”¨ä¸­çš„ä¸€ä¸ªç»„ä»¶ï¼Œç”¨äºåŠ è½½å’Œæ˜¾ç¤º Web å†…å®¹ã€‚å¼€å‘è€…éœ€è¦äº†è§£å¦‚ä½•åœ¨åŸç”Ÿåº”ç”¨ä¸­åµŒå…¥ WebViewï¼Œå¹¶é…ç½®å…¶å±æ€§ä»¥æ»¡è¶³åº”ç”¨éœ€æ±‚ã€‚</li><li><strong>JavaScript ä¸åŸç”Ÿä»£ç çš„äº¤äº’</strong>ï¼šJavaScript æ˜¯ Web æŠ€æœ¯ä¸­çš„æ ¸å¿ƒè¯­è¨€ï¼Œç”¨äºå®ç°åº”ç”¨ç•Œé¢å’Œä¸šåŠ¡é€»è¾‘ã€‚å¼€å‘è€…éœ€è¦äº†è§£å¦‚ä½•é€šè¿‡ JavaScript è°ƒç”¨åŸç”Ÿä»£ç æä¾›çš„åŠŸèƒ½ï¼Œå¦‚è®¿é—®è®¾å¤‡æ‘„åƒå¤´ã€è·å–ç”¨æˆ·ä½ç½®ç­‰ã€‚åŒæ—¶ï¼Œä¹Ÿéœ€è¦äº†è§£å¦‚ä½•å°†åŸç”Ÿä»£ç çš„ç»“æœä¼ é€’å› JavaScript ä¸­ã€‚</li><li><strong>è·¨å¹³å°é€‚é…ä¸ä¼˜åŒ–</strong>ï¼šæ··åˆå¼€å‘è™½ç„¶å¯ä»¥å®ç°è·¨å¹³å°å¼€å‘ï¼Œä½†ä¸åŒå¹³å°ä¹‹é—´çš„å·®å¼‚ä»ç„¶éœ€è¦å¼€å‘è€…è¿›è¡Œé€‚é…å’Œä¼˜åŒ–ã€‚è¿™åŒ…æ‹¬ UI å¸ƒå±€ã€æ€§èƒ½ä¼˜åŒ–ã€è®¾å¤‡å…¼å®¹æ€§ç­‰æ–¹é¢ã€‚</li></ul><h2 id="4-h5-" tabindex="-1">4. H5 å’ŒåŸç”Ÿåº”ç”¨äº¤äº’æ–¹å¼ <a class="header-anchor" href="#4-h5-" aria-label="Permalink to &quot;4. H5 å’ŒåŸç”Ÿåº”ç”¨äº¤äº’æ–¹å¼&quot;">â€‹</a></h2><h3 id="4-1-webview-javascript-interface" tabindex="-1">4.1 WebView JavaScript Interface <a class="header-anchor" href="#4-1-webview-javascript-interface" aria-label="Permalink to &quot;4.1 WebView JavaScript Interface&quot;">â€‹</a></h3><p>åœ¨ WebView ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ JavaScript æ¥å£ä¸ WebView å®¹å™¨ä¸­çš„åŸç”Ÿä»£ç è¿›è¡Œäº¤äº’ã€‚</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// JavaScript ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">window.jsInterface.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">someFun</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(arg);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">window.sdk </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  someFun</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Java ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">webView.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addJavascriptInterface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @JavascriptInterface</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    public void </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">someFun</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">String</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // å¤„ç†æ¥æ”¶åˆ°çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;jsInterface&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// WebView æä¾›äº†ä¸‰ä¸ª API ç”¨äºè°ƒç”¨ JSï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// void callHandler(String method, Object[] args)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// void callHandler(String method, Object[] args, CompletionHandler handler)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// void evaluateJavascript(String script)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">webView.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">evaluateJavascript</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;window.sdk.someFun(10)&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ValueCallback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @Override</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    public void </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onReceiveValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">String</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // è¿”å›å€¼ä¸º 20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="4-2-intent-custom-scheme" tabindex="-1">4.2 Intent å’Œ Custom Scheme <a class="header-anchor" href="#4-2-intent-custom-scheme" aria-label="Permalink to &quot;4.2 Intent å’Œ Custom Scheme&quot;">â€‹</a></h3><p>H5 é¡µé¢å¯ä»¥é€šè¿‡è‡ªå®šä¹‰ URL Scheme å¯åŠ¨åŸç”Ÿåº”ç”¨æˆ–è€…ä¼ é€’æ•°æ®ã€‚</p><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- HTML ä»£ç  --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> href</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;myapp://some/path&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;æ‰“å¼€åŸç”Ÿåº”ç”¨&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Java ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyActivity</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Activity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    protected</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onCreate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Bundle </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">savedInstanceState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        super</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onCreate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(savedInstanceState);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Uri uri </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getIntent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // æ ¹æ® URI å¤„ç†ç›¸åº”çš„æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ£€æŸ¥ app æ˜¯å¦æ‰“å¼€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> checkOpen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> clickTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> check</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">elsTime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (elsTime </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.hidden </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.webkitHidden) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // å¯åŠ¨é—´éš” 20ms è¿è¡Œçš„å®šæ—¶å™¨ï¼Œå¹¶æ£€æµ‹ç´¯è®¡æ¶ˆè€—æ—¶é—´æ˜¯å¦è¶…è¿‡ 3000msï¼Œè¶…è¿‡åˆ™ç»“æŸ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> count </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> intHandle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  intHandle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    count</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> elsTime</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> clickTime;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (count </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> elsTime </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      clearInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(intHandle);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      check</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(elsTime);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * å”¤èµ· app</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {string}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> uri</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> app schema</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {Function}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fallback</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> å”¤èµ·å¤±è´¥å›è°ƒ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> openApp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">uri</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fallback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ifr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;iframe&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ifr.src </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> uri;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ifr.style.display </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;none&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (fallback) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    checkOpen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">opened</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">opened) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        fallback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  document.body.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">appendChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ifr);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    document.body.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">removeChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ifr);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h3 id="4-3-cordova-phonegap" tabindex="-1">4.3 Cordova/PhoneGap <a class="header-anchor" href="#4-3-cordova-phonegap" aria-label="Permalink to &quot;4.3 Cordova/PhoneGap&quot;">â€‹</a></h3><p>Cordova æ˜¯ä¸€ä¸ªå°† H5 ä½œä¸ºæ¡¥æ¢ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿæ„å»ºè·¨å¹³å°åº”ç”¨çš„å¼€æºç§»åŠ¨å¼€å‘æ¡†æ¶ã€‚å®ƒå…è®¸ä½¿ç”¨æ ‡å‡†çš„ web æŠ€æœ¯ï¼Œå¦‚ HTMLã€CSS å’Œ JavaScriptï¼Œå¹¶é€šè¿‡æ’ä»¶ä¸åŸç”ŸåŠŸèƒ½è¿›è¡Œäº¤äº’ã€‚</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// JavaScript ä»£ç </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cordova.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">exec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(successCallback, errorCallback, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;NativePlugin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;someFunction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [arg0, arg1]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Java ä»£ç  (Cordova æ’ä»¶)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">public </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NativePlugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CordovaPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> boolean </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">String</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">JSONArray</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">CallbackContext</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> callbackContext</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) throws JSONException {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;someFunction&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(action)) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // å¤„ç†æ¥æ”¶åˆ°çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="4-4-react-native-flutter" tabindex="-1">4.4 React Native å’Œ Flutter <a class="header-anchor" href="#4-4-react-native-flutter" aria-label="Permalink to &quot;4.4 React Native å’Œ Flutter&quot;">â€‹</a></h3><p>è¿™äº›æ¡†æ¶å…è®¸ä½¿ç”¨ JavaScript æˆ– Dart ç¼–å†™åº”ç”¨ï¼Œå¹¶åˆ©ç”¨åŸç”Ÿç³»ç»ŸåŠŸèƒ½ã€‚å®ƒä»¬é€šå¸¸æœ‰è‡ªå·±çš„æœºåˆ¶ä¸åŸç”Ÿä»£ç äº¤äº’ã€‚</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// React Native ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { NativeModules } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;react-native&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NativeModules.NativeModule.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">someFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(arg, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // å¤„ç†ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="5-dsbridge-" tabindex="-1">5. DSBridge æ¡†æ¶è¯¦è§£ <a class="header-anchor" href="#5-dsbridge-" aria-label="Permalink to &quot;5. DSBridge æ¡†æ¶è¯¦è§£&quot;">â€‹</a></h2><p>DSBridge æ˜¯ä¸€ä¸ªä¼˜ç§€çš„ JavaScript Bridge æ¡†æ¶ï¼Œç”¨äºåœ¨ web å’Œ native ä¹‹é—´è¿›è¡Œäº¤äº’ï¼Œå¦‚ä¼ é€’æ•°æ®ã€è°ƒç”¨å‡½æ•°ç­‰ã€‚</p><h3 id="5-1-dsbridge-" tabindex="-1">5.1 DSBridge ç‰¹æ€§ <a class="header-anchor" href="#5-1-dsbridge-" aria-label="Permalink to &quot;5.1 DSBridge ç‰¹æ€§&quot;">â€‹</a></h3><p>ç›®å‰ GitHub ä¸Šå¼€æºè¾ƒå¹¿çš„ JavaScript Bridge æ¡†æ¶æœ‰ WebViewJavascriptBridgeã€JsBridge å’Œ DSBridgeã€‚DSBridge å…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š</p><ul><li><strong>è·¨å¹³å°æ”¯æŒ</strong>ï¼šå®˜æ–¹åŒæ—¶æ”¯æŒ iOS å’Œ Android</li><li><strong>åŒå‘è°ƒç”¨</strong>ï¼šJS å¯ä»¥è°ƒç”¨ Nativeï¼ŒNative ä¹Ÿå¯ä»¥è°ƒç”¨ JS</li><li><strong>åŒæ­¥ä¸å¼‚æ­¥</strong>ï¼šä¸ä»…æ”¯æŒå¼‚æ­¥è°ƒç”¨ï¼Œè¿˜æ”¯æŒåŒæ­¥è°ƒç”¨ï¼ˆDSBridge æ˜¯å”¯ä¸€ä¸€ä¸ªæ”¯æŒåŒæ­¥è°ƒç”¨çš„ JavaScript Bridgeï¼‰</li><li><strong>æ˜“ç”¨æ€§</strong>ï¼šä¸‰ç«¯å‹å¥½ï¼Œæ¥å£æ˜“ç”¨æ€§æ¯” WebViewJavascriptBridge æ›´å¼º</li></ul><h3 id="5-2-h5-" tabindex="-1">5.2 H5 è°ƒç”¨åŸç”Ÿ <a class="header-anchor" href="#5-2-h5-" aria-label="Permalink to &quot;5.2 H5 è°ƒç”¨åŸç”Ÿ&quot;">â€‹</a></h3><p>åŸç†ï¼šé€šè¿‡æ‹¦æˆª JavaScript çš„ prompt äº‹ä»¶ï¼Œè§£æå‡ºå¯¹åº”çš„ methodï¼Œç„¶ååˆ©ç”¨ objc_msgSend è°ƒç”¨ OC çš„æ–¹æ³•ã€‚è®¾è®¡å°†æ¥å£å°è£…åˆ°è‡ªå®šä¹‰çš„ JavaScriptInterface ä¸­ï¼Œæ”¯æŒå¤šä¸ª JavaScriptInterface ç±»ã€‚å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªå­—å…¸ï¼Œæ”¯æŒå¤šä¸ªå‘½åç©ºé—´ã€‚</p><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Java æ³¨å†Œä¾› H5 ä¸­ JavaScript è°ƒç”¨çš„ API</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> JsApi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ç”¨äºåŒæ­¥è°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">JavascriptInterface</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    String </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">testSyn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(JSONObject </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">jsonObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">throws</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JSONException {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // è¿”å›å€¼åªèƒ½æ˜¯å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jsonObject.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;msg&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ç”¨äºå¼‚æ­¥è°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">JavascriptInterface</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> testAsyn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(JSONObject </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">jsonObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, CompletionHandler </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">handler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">throws</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JSONException {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        handler.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">complete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(jsonObject.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;msg&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å°†å®ç°çš„ API å®‰è£…åˆ° DWebView</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wendu.dsbridge.DWebView;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DWebView dwebView </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (DWebView) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findViewById</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(R.id.dwebview);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dwebView.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setJavascriptInterface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> JsApi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åœ¨ H5 é¡µé¢ä¸­è°ƒç”¨ Java API</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dsBridge </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dsbridge&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åŒæ­¥è°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> str </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dsBridge.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;testSyn&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {msg: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;testSyn&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¼‚æ­¥è°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dsBridge.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;testAsyn&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {msg: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;testAsyn&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  alert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="5-3-h5" tabindex="-1">5.3 åŸç”Ÿè°ƒç”¨ H5 <a class="header-anchor" href="#5-3-h5" aria-label="Permalink to &quot;5.3 åŸç”Ÿè°ƒç”¨ H5&quot;">â€‹</a></h3><p>åŸç†ï¼šè°ƒç”¨ evaluateJavaScript:completionHandler: æ‰§è¡Œ JS å‡½æ•° <code>window._handleMessageFromNative</code> è°ƒç”¨ JS æ³¨å†Œçš„æ–¹æ³•ã€‚</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Javascript æ³¨å†Œä¾› Native è°ƒç”¨çš„ API</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dsBridge.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">register</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;addValue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">l</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> r;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åœ¨ Java ä¸­è°ƒç”¨ JavaScript API</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">webView.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">callHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;addValue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[]{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OnReturnValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">retValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;jsbridge&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;return value is &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> retValue);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="5-4-api-" tabindex="-1">5.4 API ç­¾åè¦æ±‚ <a class="header-anchor" href="#5-4-api-" aria-label="Permalink to &quot;5.4 API ç­¾åè¦æ±‚&quot;">â€‹</a></h3><p>ä¸ºäº†å…¼å®¹ Android å’Œ iOSï¼ŒDSBridge å¯¹ Native API çš„ç­¾åæœ‰ä¸¤ä¸ªè¦æ±‚ï¼š</p><ul><li><strong>è¿”å›å€¼ç±»å‹</strong>ï¼šè¿”å›å€¼å¿…é¡»æ˜¯ Stringï¼Œå¦‚æœæ²¡æœ‰è¿”å›å€¼ï¼Œç›´æ¥è¿”å› null å³å¯</li><li><strong>å‚æ•°ä¼ é€’</strong>ï¼šAPI çš„å‚æ•°é€šè¿‡ JSONObject ä¼ é€’ï¼Œå¦‚æœæœ‰äº› API æ²¡æœ‰å‚æ•°ï¼Œä¹Ÿéœ€è¦å£°æ˜</li></ul><h3 id="5-5-" tabindex="-1">5.5 è°ƒç”¨æ—¶æœº <a class="header-anchor" href="#5-5-" aria-label="Permalink to &quot;5.5 è°ƒç”¨æ—¶æœº&quot;">â€‹</a></h3><p>DSBridge æä¾›äº† WebViewClient ç±»ï¼Œç”¨äºç›‘å¬ WebView çš„å„ç§äº‹ä»¶ï¼Œå¦‚é¡µé¢åŠ è½½å®Œæˆã€é¡µé¢åŠ è½½å¤±è´¥ç­‰ã€‚é€šè¿‡è¿™äº›äº‹ä»¶çš„ç›‘å¬ï¼Œå¯ä»¥å®ç°æ›´åŠ å¤æ‚çš„äº¤äº’é€»è¾‘ã€‚</p><p>DWebView åªæœ‰åœ¨ JavaScript context åˆå§‹åŒ–æˆåŠŸåæ‰èƒ½æ­£ç¡®æ‰§è¡Œ JS ä»£ç ï¼Œè€Œ JavaScript context åˆå§‹åŒ–å®Œæˆçš„æ—¶æœºä¸€èˆ¬éƒ½æ¯”æ•´ä¸ªé¡µé¢åŠ è½½å®Œæ¯•è¦æ—©ã€‚è™½ç„¶ DSBridge èƒ½æ•è·åˆ° JavaScript context åˆå§‹åŒ–å®Œæˆçš„æ—¶æœºï¼Œä½†æ˜¯ä¸€äº› JS API å¯èƒ½å£°æ˜åœ¨é¡µé¢å°¾éƒ¨ï¼Œç”šè‡³å•ç‹¬çš„ JS æ–‡ä»¶ä¸­ï¼Œå¦‚æœåœ¨ JavaScript context åˆšåˆå§‹åŒ–å®Œæˆå°±è°ƒç”¨ JS APIï¼Œæ­¤æ—¶ JS API å¯èƒ½è¿˜æ²¡æœ‰æ³¨å†Œï¼Œæ‰€ä»¥ä¼šå¤±è´¥ã€‚å› æ­¤ï¼Œå¦‚æœæ˜¯å®¢æˆ·ç«¯ä¸»åŠ¨è°ƒç”¨ JSï¼Œåº”è¯¥åœ¨ onPageFinished åè°ƒç”¨ï¼š</p><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">webView.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setWebViewClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> WebViewClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onPageFinished</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(WebView </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">view</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        super</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onPageFinished</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(view, url);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // æœŸæœ›è¿”å›å€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        webView.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">callHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[]{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CompletionHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> complete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">retValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                Log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;jsbridge&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;call succeed, return value is &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> retValue);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        });</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // ä¸æœŸæœ›è¿”å›å€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        webView.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">callHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="6-dsbridge-" tabindex="-1">6. DSBridge åŸç†è§£æ <a class="header-anchor" href="#6-dsbridge-" aria-label="Permalink to &quot;6. DSBridge åŸç†è§£æ&quot;">â€‹</a></h2><h3 id="6-1-javascript-" tabindex="-1">6.1 JavaScript æ ¸å¿ƒå®ç° <a class="header-anchor" href="#6-1-javascript-" aria-label="Permalink to &quot;6.1 JavaScript æ ¸å¿ƒå®ç°&quot;">â€‹</a></h3><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bridge </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // JS è°ƒç”¨ Native çš„æ–¹æ³•å…¥å£</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">method</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    arg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(arg);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (window._dsbridge) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ret </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _dsbridge.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(method, arg);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (window._dswk </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> navigator.userAgent.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">indexOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;_dsbridge&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // è°ƒç”¨ prompt å‡½æ•°ï¼ŒNative ä¼šæ‹¦æˆª prompt äº‹ä»¶ï¼Œç„¶åæ‰§è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ret </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> prompt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;_dsbridge=&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> method, arg);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ret </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;{}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).data;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Native è°ƒç”¨çš„æ–¹æ³•ä½¿ç”¨æ­¤æ–¹æ³•æ³¨å†Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // å¾€ window æ³¨å…¥å…¨å±€å‚æ•°ï¼Œå¦‚å­˜å‚¨ JS çš„æ³¨å†Œæ–¹æ³•ç­‰</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  register</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fun</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">asyn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // æ³¨å†Œçš„æ–¹æ³•ä¼šä¿å­˜åˆ° window ä¸Šï¼Œæ–¹ä¾¿åŸç”Ÿè°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> q </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> asyn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> window._dsaf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> window._dsf;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // object ç±»å‹ä¿å­˜åˆ° _obs ä¸‹ï¼Œæ–¹æ³•ç›´æ¥ä¿å­˜åˆ° _dsf(_dsaf) ä¸‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fun </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;object&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      q._obs[name] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fun;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      q[name] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fun;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="6-2-native-" tabindex="-1">6.2 Native æ ¸å¿ƒå®ç° <a class="header-anchor" href="#6-2-native-" aria-label="Permalink to &quot;6.2 Native æ ¸å¿ƒå®ç°&quot;">â€‹</a></h3><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç«‹å³æ‰§è¡Œå‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // åˆ¤æ–­æ˜¯å¦éœ€è¦ç»™ window è¿›è¡Œå‚æ•°æ·»åŠ ï¼Œå¦‚æœæ²¡æœ‰æ·»åŠ ä¼šæŠŠ ob å†…å‚æ•°è¿›è¡Œä¸€æ¬¡æ·»åŠ </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (window._dsf) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // åŸç”Ÿåˆå§‹åŒ–æ—¶ï¼Œä¼šæŠŠæ•°æ®æŒ‚è½½åˆ° window ä¸Š</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ob </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // æ˜¯å¦åœ¨åŸç”Ÿ webview ä¸­è¿è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    _dswk: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // å­˜å‚¨åŒæ­¥æ–¹æ³•å’Œç›¸å…³å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    _dsf: { _obs: {} },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // å­˜å‚¨å¼‚æ­¥æ–¹æ³•å’Œç›¸å…³å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    _dsaf: { _obs: {} },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    dscb: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// é¿å…æ–¹æ³•åŒåæ¯æ¬¡åŠ  1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    _dsBridge: bridge,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // å¤„ç† Native è°ƒç”¨ JS æ–¹æ³•ï¼Œæ ¸å¿ƒå®ç°å¦‚ä¸‹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    _handleMessageFromNative</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // é€šè¿‡ info.method è·å–æ–¹æ³•å®ç°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">._dsf[info.method];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // é€šè¿‡ info.data è·å–å…¥å‚ï¼Œæ•°ç»„å½¢å¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(info.data);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // ä½¿ç”¨ apply å‡½æ•°ï¼Œè°ƒç”¨å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      f.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ob, arg);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="7-" tabindex="-1">7. æ··åˆå¼€å‘æœ€ä½³å®è·µ <a class="header-anchor" href="#7-" aria-label="Permalink to &quot;7. æ··åˆå¼€å‘æœ€ä½³å®è·µ&quot;">â€‹</a></h2><h3 id="7-1-" tabindex="-1">7.1 æ€§èƒ½ä¼˜åŒ– <a class="header-anchor" href="#7-1-" aria-label="Permalink to &quot;7.1 æ€§èƒ½ä¼˜åŒ–&quot;">â€‹</a></h3><ul><li><strong>å‡å°‘ DOM æ“ä½œ</strong>ï¼šé¢‘ç¹çš„ DOM æ“ä½œä¼šå¯¼è‡´é¡µé¢é‡ç»˜å’Œå›æµï¼Œå½±å“æ€§èƒ½</li><li><strong>ä½¿ç”¨æœ¬åœ°ç¼“å­˜</strong>ï¼šå°†å¸¸ç”¨çš„æ•°æ®å’Œèµ„æºç¼“å­˜åˆ°æœ¬åœ°ï¼Œå‡å°‘ç½‘ç»œè¯·æ±‚</li><li><strong>å»¶è¿ŸåŠ è½½</strong>ï¼šå¯¹äºä¸æ˜¯ç«‹å³éœ€è¦çš„å†…å®¹ï¼Œå¯ä»¥é‡‡ç”¨å»¶è¿ŸåŠ è½½çš„æ–¹å¼</li><li><strong>å‡å°‘ Bridge è°ƒç”¨</strong>ï¼šBridge è°ƒç”¨æ˜¯æ··åˆåº”ç”¨çš„æ€§èƒ½ç“¶é¢ˆï¼Œåº”å°½é‡å‡å°‘è°ƒç”¨æ¬¡æ•°</li></ul><h3 id="7-2-" tabindex="-1">7.2 ç”¨æˆ·ä½“éªŒæå‡ <a class="header-anchor" href="#7-2-" aria-label="Permalink to &quot;7.2 ç”¨æˆ·ä½“éªŒæå‡&quot;">â€‹</a></h3><ul><li><strong>é¢„åŠ è½½é¡µé¢</strong>ï¼šæå‰åŠ è½½ä¸‹ä¸€ä¸ªå¯èƒ½è®¿é—®çš„é¡µé¢ï¼Œå‡å°‘ç”¨æˆ·ç­‰å¾…æ—¶é—´</li><li><strong>è¿‡æ¸¡åŠ¨ç”»</strong>ï¼šæ·»åŠ é€‚å½“çš„è¿‡æ¸¡åŠ¨ç”»ï¼Œæå‡ç”¨æˆ·ä½“éªŒ</li><li><strong>ç¦»çº¿æ”¯æŒ</strong>ï¼šå®ç°åŸºæœ¬çš„ç¦»çº¿åŠŸèƒ½ï¼Œæé«˜åº”ç”¨çš„å¯ç”¨æ€§</li><li><strong>é”™è¯¯å¤„ç†</strong>ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œæä¾›å‹å¥½çš„é”™è¯¯æç¤º</li></ul><h3 id="7-3-" tabindex="-1">7.3 å®‰å…¨æ€§è€ƒè™‘ <a class="header-anchor" href="#7-3-" aria-label="Permalink to &quot;7.3 å®‰å…¨æ€§è€ƒè™‘&quot;">â€‹</a></h3><ul><li><strong>æ•°æ®åŠ å¯†</strong>ï¼šæ•æ„Ÿæ•°æ®åœ¨ä¼ è¾“å’Œå­˜å‚¨æ—¶åº”è¿›è¡ŒåŠ å¯†</li><li><strong>è¾“å…¥éªŒè¯</strong>ï¼šå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡ŒéªŒè¯ï¼Œé˜²æ­¢æ³¨å…¥æ”»å‡»</li><li><strong>æƒé™æ§åˆ¶</strong>ï¼šå¯¹ Native API çš„è®¿é—®è¿›è¡Œæƒé™æ§åˆ¶</li><li><strong>HTTPS é€šä¿¡</strong>ï¼šä½¿ç”¨ HTTPS åè®®è¿›è¡Œé€šä¿¡ï¼Œä¿è¯æ•°æ®ä¼ è¾“å®‰å…¨</li></ul><h2 id="8-" tabindex="-1">8. å‚è€ƒèµ„æº <a class="header-anchor" href="#8-" aria-label="Permalink to &quot;8. å‚è€ƒèµ„æº&quot;">â€‹</a></h2><ul><li><a href="https://github.com/wendux/DSBridge-Android" target="_blank" rel="noreferrer">DSBridge GitHub ä»“åº“</a></li><li><a href="https://cordova.apache.org/docs/en/latest/" target="_blank" rel="noreferrer">Cordova å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://developer.android.com/guide/webapps/webview" target="_blank" rel="noreferrer">WebView å¼€å‘æŒ‡å—</a></li><li><a href="https://reactnative.dev/docs/getting-started" target="_blank" rel="noreferrer">React Native å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://flutter.dev/docs" target="_blank" rel="noreferrer">Flutter å®˜æ–¹æ–‡æ¡£</a></li></ul>`,66)]))}const b=i(h,[["render",t]]);export{y as __pageData,b as default};
